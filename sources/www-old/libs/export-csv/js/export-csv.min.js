!function(t){"use strict";function e(e,o,n,r,a){var s,c,l,p=(e.options.exporting||{}).csv||{},m=p.url||"http://www.highcharts.com/studies/csv-export/download.php";l=e.options.exporting.filename?e.options.exporting.filename:e.title?e.title.textStr.replace(/ /g,"-").toLowerCase():"chart",i?(s=document.createElement("a"),s.href=o,s.target="_blank",s.download=l+"."+n,document.body.appendChild(s),s.click(),s.remove()):window.Blob&&window.navigator.msSaveOrOpenBlob?(c=new Blob([r]),window.navigator.msSaveOrOpenBlob(c,l+"."+n)):t.post(m,{data:r,type:a,extension:n})}var o=t.each,n=t.pick,i=void 0!==document.createElement("a").download;t.setOptions({lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS"}}),t.Chart.prototype.getDataRows=function(){var e,i,r,a=(this.options.exporting||{}).csv||{},s=this.xAxis[0],c={},l=[],p=[],m=a.dateFormat||"%Y-%m-%d %H:%M:%S",x=a.columnHeaderFormatter||function(t,e,o){return t.name+(o>1?" ("+e+")":"")};i=0,o(this.series,function(t){var e,r=t.options.keys,a=r||t.pointArrayMap||["y"],s=a.length,l=t.requireSorting,m={};if(o(a,function(e){m[e]=t[e+"Axis"]&&t[e+"Axis"].categories||[]}),t.options.includeInCSVExport!==!1&&t.visible!==!1){for(e=0;s>e;)p.push(x(t,a[e],a.length)),e+=1;o(t.points,function(o,r){var p,x,d=l?o.x:r;for(e=0,c[d]||(c[d]=[]),c[d].x=o.x,t.xAxis||(c[d].name=o.name);s>e;)p=a[e],x=o[p],c[d][i+e]=n(m[p][x],x),e+=1}),i+=e}});for(r in c)c.hasOwnProperty(r)&&l.push(c[r]);return l.sort(function(t,e){return t.x-e.x}),e=[[s.isDatetimeAxis?"DateTime":"Category"].concat(p)],o(l,function(o){var i=o.name;i||(i=s.isDatetimeAxis?t.dateFormat(m,o.x):s.categories?n(s.names[o.x],s.categories[o.x],o.x):o.x),o.unshift(i),e.push(o)}),e},t.Chart.prototype.getCSV=function(t){var e="",n=this.getDataRows(),i=(this.options.exporting||{}).csv||{},r=i.itemDelimiter||",",a=i.lineDelimiter||"\n";return o(n,function(o,i){for(var s="",c=o.length,l=t?1.1.toLocaleString()[1]:".";c--;)s=o[c],"string"==typeof s&&(s='"'+s+'"'),"number"==typeof s&&","===l&&(s=s.toString().replace(".",",")),o[c]=s;e+=o.join(r),i<n.length-1&&(e+=a)}),e},t.Chart.prototype.getTable=function(t){var e="<table>",n=this.getDataRows();return o(n,function(o,n){var i,r,a=n?"td":"th",s=t?1.1.toLocaleString()[1]:".";for(e+="<tr>",r=0;r<o.length;r+=1)i=o[r],e+="number"==typeof i?","===s?"<"+a+("number"==typeof i?' class="number"':"")+">"+i.toString().replace(".",",")+"</"+a+">":"<"+a+("number"==typeof i?' class="number"':"")+">"+i.toString()+"</"+a+">":"<"+a+">"+i+"</"+a+">";e+="</tr>"}),e+="</table>"},t.Chart.prototype.downloadCSV=function(){var t=this.getCSV(!0);e(this,"data:text/csv,"+t.replace(/\n/g,"%0A"),"csv",t,"text/csv")},t.Chart.prototype.downloadXLS=function(){var t="data:application/vnd.ms-excel;base64,",o='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";}</style><meta name=ProgId content=Excel.Sheet></head><body>'+this.getTable(!0)+"</body></html>",n=function(t){return window.btoa(unescape(encodeURIComponent(t)))};e(this,t+n(o),"xls",o,"application/vnd.ms-excel")},t.getOptions().exporting&&t.getOptions().exporting.buttons.contextButton.menuItems.push({textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}})}(Highcharts);